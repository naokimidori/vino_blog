{"hash":"97c054ee66bf0804048bac66282004dce89f4873","data":{"post":{"title":"webpack学习笔记","path":"/post/ba8fa557e17fd4025947c9026cb8512e/","date":"2019/06/30","timeToRead":1,"tags":[{"id":"webpack","title":"webpack","path":"/tag/webpack/"},{"id":"工程化","title":"工程化","path":"/tag/%E5%B7%A5%E7%A8%8B%E5%8C%96/"}],"content":"<h2 id=\"webpack-介绍\"><a href=\"#webpack-%E4%BB%8B%E7%BB%8D\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>webpack 介绍</h2>\n<p>Webpack 是前端 <strong>模块化管理</strong> 和 <strong>打包工具</strong>。它可以将许多松散的模块按照依赖和规则打包成前端资源。还可以将模块<strong>按需加载</strong>。\n通过 <code class=\"language-text\">loader</code> 的转换，任何形式的资源都可以视作模块，比如 CommonJs 模块、ES6 模块、CSS、图片、 JSON、Coffeescript、 LESS 等。</p>\n<blockquote>\n<p>本质上，webpack 是一个现代 JavaScript 应用程序的静态模块打包器(module bundler)。当 webpack 处理应用程序时，它会递归地构建一个依赖关系图(dependency graph)，其中包含应用程序需要的每个模块，然后将所有这些模块打包成一个或多个 bundle。</p>\n</blockquote>\n<p><img src=\"https://s2.ax1x.com/2019/09/02/nPRU2j.png\" alt=\"webpack原理\"></p>\n<h3 id=\"webpack-四个核心概念\"><a href=\"#webpack-%E5%9B%9B%E4%B8%AA%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>webpack 四个核心概念</h3>\n<ul>\n<li>入口(entry)</li>\n<li>输出(output)</li>\n<li>loader</li>\n<li>插件(plugins)</li>\n</ul>\n<h3 id=\"关于模块化\"><a href=\"#%E5%85%B3%E4%BA%8E%E6%A8%A1%E5%9D%97%E5%8C%96\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>关于模块化</h3>\n<ol>\n<li>模块：拥有独立功能的部分</li>\n<li>模块化：一种将系统分离成独立功能部分的方法</li>\n<li>模块化解决的问题： <strong>避免变量污染</strong></li>\n</ol>\n<h3 id=\"commonjs-规范\"><a href=\"#commonjs-%E8%A7%84%E8%8C%83\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>CommonJS 规范</h3>\n<p><strong>nodejs 采用了 CommonJS 模块化规范</strong></p>\n<ol>\n<li>每个文件就是一个独立的模块，其内部所有变量私有，对外不可见</li>\n<li>每个模块内部使用 module.exports 进行私有暴露</li>\n<li>加载模块使用 require</li>\n</ol>\n<h3 id=\"es5-模块\"><a href=\"#es5-%E6%A8%A1%E5%9D%97\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>ES5 模块</h3>\n<pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">//引入</span>\n<span class=\"token keyword\">var</span> a <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"./a.js\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">var</span> $ <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"jquery\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">//暴露</span>\n<span class=\"token keyword\">var</span> <span class=\"token function-variable function\">fuc</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\nmodule<span class=\"token punctuation\">.</span><span class=\"token property-access\">exports</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">fuc</span> <span class=\"token operator\">=</span> fuc<span class=\"token punctuation\">;</span></code></pre>\n<h3 id=\"es6-模块（2015）\"><a href=\"#es6-%E6%A8%A1%E5%9D%97%EF%BC%882015%EF%BC%89\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>ES6 模块（2015）</h3>\n<pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">//引入</span>\n<span class=\"token keyword module\">import</span> <span class=\"token imports\">a</span> <span class=\"token keyword module\">from</span> '<span class=\"token punctuation\">.</span><span class=\"token operator\">/</span>a<span class=\"token punctuation\">.</span><span class=\"token property-access\">js</span>\n\n<span class=\"token comment\">//暴露</span>\n<span class=\"token keyword module\">export</span> <span class=\"token keyword\">var</span> <span class=\"token function-variable function\">fuc</span><span class=\"token operator\">=</span><span class=\"token punctuation\">(</span> <span class=\"token punctuation\">)</span><span class=\"token arrow operator\">=></span><span class=\"token punctuation\">{</span> <span class=\"token punctuation\">}</span></code></pre>\n<h2 id=\"webpack-安装\"><a href=\"#webpack-%E5%AE%89%E8%A3%85\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>webpack 安装</h2>\n<h3 id=\"全局安装安装命令行工具\"><a href=\"#%E5%85%A8%E5%B1%80%E5%AE%89%E8%A3%85%E5%AE%89%E8%A3%85%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%B7%A5%E5%85%B7\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>全局安装,安装命令行工具</h3>\n<p><code class=\"language-text\">yarn global add webpack</code> 或 <code class=\"language-text\">npm install --global webpack</code></p>\n<h3 id=\"项目安装\"><a href=\"#%E9%A1%B9%E7%9B%AE%E5%AE%89%E8%A3%85\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>项目安装</h3>\n<p>初始化\n<code class=\"language-text\">yarn init -y</code> 或 <code class=\"language-text\">npm init -y</code></p>\n<p>项目安装依赖\n<code class=\"language-text\">yarn add webpack@3.8.1 --save-dev</code></p>\n<h2 id=\"配置文件-webpackconfigjs\"><a href=\"#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6-webpackconfigjs\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>配置文件 webpack.config.js</h2>\n<blockquote>\n<p>以 3.8.1 版本为例</p>\n</blockquote>\n<pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> webpack <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"webpack\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">var</span> path <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"path\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">//webpack配置对象</span>\nmodule<span class=\"token punctuation\">.</span><span class=\"token property-access\">exports</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">//入口</span>\n    entry<span class=\"token operator\">:</span> <span class=\"token string\">\"./src/a.js\"</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 单入单出</span>\n    <span class=\"token comment\">// entry:['./src/a.js','./src/c.js'],   //多入口 单出口</span>\n    <span class=\"token comment\">// entry: {                  //多入口，多出口</span>\n    <span class=\"token comment\">//     // key(打包以后的文件名): value(入口路径)</span>\n    <span class=\"token comment\">//     amodule: './src/a.js',</span>\n    <span class=\"token comment\">//     cmodule: './src/c.js'</span>\n    <span class=\"token comment\">// },</span>\n    <span class=\"token comment\">// 配置输出</span>\n    output<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">//输出的路径(硬盘输出)</span>\n        path<span class=\"token operator\">:</span> path<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">resolve</span><span class=\"token punctuation\">(</span>__dirname<span class=\"token punctuation\">,</span> <span class=\"token string\">\"dist/\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token comment\">//输出的文件名</span>\n        filename<span class=\"token operator\">:</span> <span class=\"token string\">\"bundle.js\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token comment\">// filename: \"[name].js\",  /*多出口需设置filename*/</span>\n        <span class=\"token comment\">// webpack-dev-server 服务器输出路径</span>\n        publicPath<span class=\"token operator\">:</span> <span class=\"token string\">\"/dist/\"</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">//loader加载器配置</span>\n    module<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        rules<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n            <span class=\"token comment\">// css-loader</span>\n            <span class=\"token punctuation\">{</span>\n                test<span class=\"token operator\">:</span> <span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\"><span class=\"token special-escape escape\">\\.</span>css<span class=\"token anchor function\">$</span></span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">,</span>\n                use<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"style-loader\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"css-loader\"</span><span class=\"token punctuation\">]</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token comment\">//less-loader</span>\n            <span class=\"token punctuation\">{</span>\n                test<span class=\"token operator\">:</span> <span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\"><span class=\"token special-escape escape\">\\.</span>less<span class=\"token anchor function\">$</span></span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">,</span>\n                use<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n                    <span class=\"token punctuation\">{</span>\n                        loader<span class=\"token operator\">:</span> <span class=\"token string\">\"style-loader\"</span> <span class=\"token comment\">// creates style nodes from JS strings</span>\n                    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                    <span class=\"token punctuation\">{</span>\n                        loader<span class=\"token operator\">:</span> <span class=\"token string\">\"css-loader\"</span> <span class=\"token comment\">// translates CSS into CommonJS</span>\n                    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                    <span class=\"token punctuation\">{</span>\n                        loader<span class=\"token operator\">:</span> <span class=\"token string\">\"less-loader\"</span> <span class=\"token comment\">// compiles Less to CSS</span>\n                    <span class=\"token punctuation\">}</span>\n                <span class=\"token punctuation\">]</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token comment\">//file-loader</span>\n            <span class=\"token punctuation\">{</span>\n                test<span class=\"token operator\">:</span> <span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\"><span class=\"token special-escape escape\">\\.</span><span class=\"token group punctuation\">(</span>png<span class=\"token alternation keyword\">|</span>jpg<span class=\"token alternation keyword\">|</span>gif<span class=\"token group punctuation\">)</span><span class=\"token anchor function\">$</span></span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">,</span>\n                use<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n                    <span class=\"token punctuation\">{</span>\n                        loader<span class=\"token operator\">:</span> <span class=\"token string\">\"file-loader\"</span><span class=\"token punctuation\">,</span>\n                        options<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n                    <span class=\"token punctuation\">}</span>\n                <span class=\"token punctuation\">]</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">//所有插件都写在此处！！！！</span>\n    plugins<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token keyword\">new</span> <span class=\"token class-name\">webpack<span class=\"token punctuation\">.</span>BannerPlugin</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"作者: naoki\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token keyword\">new</span> <span class=\"token class-name\">webpack<span class=\"token punctuation\">.</span>optimize<span class=\"token punctuation\">.</span>CommonsChunkPlugin</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"common\"</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">//提取公共模块</span>\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">//自动打包</span>\n    watch<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre>\n<hr>\n"}},"context":{}}